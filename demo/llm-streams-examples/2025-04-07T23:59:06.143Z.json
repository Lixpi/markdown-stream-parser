[
    "#",
    " NATS Authentication Callout Configuration:",
    " Understanding `xkey`\n\nIn NATS authentication callout",
    " configuration, the `xkey` is an",
    " important element of the cryptographic security mechanism use",
    "d to verify the authenticity of authentication callout",
    " requests and responses.\n\n## What is an x",
    "key?\n\nThe `xkey` (",
    "external key) is a shared secret key that's",
    " used to sign and verify JSON Web Tokens (J",
    "WTs) exchanged between the N",
    "ATS server and an external authentication service. This",
    " ensures that:\n\n1. The",
    " NATS server can verify that responses come from the authorize",
    "d authentication service\n2. The authentication service can verify that requests",
    " originate from the legitimate NATS server",
    "\n\n## How xkey is Used in Configuration\n\nIn a",
    " NATS server configuration, you would typically define",
    " the xkey in the auth_callout section:",
    "\n\n```json\nauthorization {\n  auth_",
    "callout {\n    issuer: \"iss",
    "uer_name\"\n    xkey: \"a",
    "_strong_shared_secret_key_",
    "here\"\n    url: \"http://auth",
    "-service:8080/auth\"\n    ",
    "// other configuration options...\n  }\n}",
    "\n```\n\n## Security Considerations\n\n- The xkey should be",
    " treated as a sensitive secret\n- It should be",
    " sufficiently long and complex to resist brute force attacks",
    "\n- Best practice is to store it in environment variables or a secure vault",
    " rather than in plaintext config files\n- Both the NATS server",
    " and authentication service must use the identical xkey value\n\n## Authentication",
    " Flow with xkey\n\n1. When a client connects,",
    " NATS creates a JWT signed with the xkey",
    "\n2. This JWT is sent to the external authentication service\n3.",
    " The auth service verifies the JWT signature using the same",
    " xkey\n4. The auth service responds with a signe",
    "d JWT (using the same xkey)\n5.",
    " NATS verifies this response using the xkey before",
    " granting access\n\nThis bidirectional verification creates a",
    " secure authentication channel between NATS and your",
    " custom authentication logic."
]